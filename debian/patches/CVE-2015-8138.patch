Description: fix Zero Origin Timestamp Bypass
Origin: vendor, http://pkgs.fedoraproject.org/cgit/rpms/ntp.git/tree/ntp-4.2.6p5-cve-2015-8138.patch
Bug: http://support.ntp.org/bin/view/Main/NtpBug2945
Bug: http://support.ntp.org/bin/view/Main/NtpBug2901

Index: ntp-4.2.6.p3+dfsg/ntpd/ntp_proto.c
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/ntpd/ntp_proto.c	2016-06-01 12:27:28.707295147 -0400
+++ ntp-4.2.6.p3+dfsg/ntpd/ntp_proto.c	2016-06-01 12:27:28.707295147 -0400
@@ -1138,7 +1138,7 @@
 	 * the packet is not bogus in symmetric interleaved mode.
 	 */
 	} else if (peer->flip == 0) {
-		if (!L_ISEQU(&p_org, &peer->aorg)) {
+		if (L_ISZERO(&p_org) || !L_ISEQU(&p_org, &peer->aorg)) {
 			peer->bogusorg++;
 			peer->flash |= TEST2;	/* bogus */
 			if (!L_ISZERO(&peer->dst) && L_ISEQU(&p_org,
