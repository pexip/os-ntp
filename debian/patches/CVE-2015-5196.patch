Description: fix file overwrite via remote pidfile and driftfile
 configuration directives
Origin: vendor, http://pkgs.fedoraproject.org/cgit/ntp.git/tree/ntp-4.2.6p5-cve-2015-5196.patch

Index: ntp-4.2.6.p5+dfsg/ntpd/ntp_parser.y
===================================================================
--- ntp-4.2.6.p5+dfsg.orig/ntpd/ntp_parser.y	2015-10-22 15:55:22.498495669 -0400
+++ ntp-4.2.6.p5+dfsg/ntpd/ntp_parser.y	2015-10-22 15:55:22.498495669 -0400
@@ -988,23 +988,43 @@
 
 misc_cmd_str_keyword
 	:	T_Leapfile
-	|	T_Pidfile
 	|	T_Qos
 	;
 
 misc_cmd_str_lcl_keyword
 	:	T_Logfile
+	|	T_Pidfile
 	|	T_Saveconfigdir
 	;
 
 drift_parm
 	:	T_String
-			{ enqueue(cfgt.vars, create_attr_sval(T_Driftfile, $1)); }
+		{
+			if (input_from_file) {
+				enqueue(cfgt.vars, create_attr_sval(T_Driftfile, $1));
+			} else {
+				YYFREE($1);
+				yyerror("driftfile remote configuration ignored");
+			}
+		}
 	|	T_String T_Double
-			{ enqueue(cfgt.vars, create_attr_dval(T_WanderThreshold, $2));
-			  enqueue(cfgt.vars, create_attr_sval(T_Driftfile, $1)); }
+		{
+			if (input_from_file) {
+				enqueue(cfgt.vars, create_attr_dval(T_WanderThreshold, $2));
+				enqueue(cfgt.vars, create_attr_sval(T_Driftfile, $1));
+			} else {
+				YYFREE($1);
+				yyerror("driftfile remote configuration ignored");
+			}
+		}
 	|	/* Null driftfile,  indicated by null string "\0" */
-			{ enqueue(cfgt.vars, create_attr_sval(T_Driftfile, "\0")); }
+		{
+			if (input_from_file) {
+				enqueue(cfgt.vars, create_attr_sval(T_Driftfile, estrdup("")));
+			} else {
+				yyerror("driftfile remote configuration ignored");
+			}
+		}
 	;
 
 variable_assign
