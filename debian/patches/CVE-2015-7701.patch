From d7cd5e186034340402f1393e0813c7d2b14ea6ca Mon Sep 17 00:00:00 2001
From:  <jnperlin@hydra.localnet>
Date: Mon, 28 Sep 2015 18:22:06 +0200
Subject: [PATCH] [Bug 2909] - Slow memory leak in CRYPTO_ASSOC  - added
 missing call to 'free()' in ntp_crypto.c.

---
 ChangeLog         | 1 +
 ntpd/ntp_crypto.c | 1 +
 2 files changed, 2 insertions(+)

Index: ntp-4.2.6.p5+dfsg/ntpd/ntp_crypto.c
===================================================================
--- ntp-4.2.6.p5+dfsg.orig/ntpd/ntp_crypto.c	2015-10-22 15:25:26.448658993 -0400
+++ ntp-4.2.6.p5+dfsg/ntpd/ntp_crypto.c	2015-10-22 15:25:26.448658993 -0400
@@ -500,6 +500,7 @@
 					rval = XEVNT_ERR;
 					break;
 				}
+				free(peer->cmmd); /* will be set again! */
 			}
 			fp = emalloc(len);
 			memcpy(fp, ep, len);
