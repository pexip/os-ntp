Description: fix buffer comparison timing attacks
Origin: vendor, http://pkgs.fedoraproject.org/cgit/rpms/ntp.git/tree/ntp-4.2.6p5-cve-2016-1550.patch
Bug: http://support.ntp.org/bin/view/Main/NtpBug2879

Index: ntp-4.2.6.p5+dfsg/libntp/a_md5encrypt.c
===================================================================
--- ntp-4.2.6.p5+dfsg.orig/libntp/a_md5encrypt.c	2016-06-01 11:18:22.702295683 -0400
+++ ntp-4.2.6.p5+dfsg/libntp/a_md5encrypt.c	2016-06-01 11:18:46.446620254 -0400
@@ -80,7 +80,7 @@
 		    "MAC decrypt: MAC length error");
 		return (0);
 	}
-	return (!memcmp(digest, (char *)pkt + length + 4, len));
+	return (!CRYPTO_memcmp(digest, (char *)pkt + length + 4, len));
 }
 
 /*
Index: ntp-4.2.6.p5+dfsg/sntp/crypto.c
===================================================================
--- ntp-4.2.6.p5+dfsg.orig/sntp/crypto.c	2016-06-01 11:18:22.702295683 -0400
+++ ntp-4.2.6.p5+dfsg/sntp/crypto.c	2016-06-01 11:18:22.702295683 -0400
@@ -58,7 +58,7 @@
 	if (!hash_len)
 		authentic = FALSE;
 	else
-		authentic = !memcmp(digest, pkt_data + pkt_size + 4,
+		authentic = !CRYPTO_memcmp(digest, pkt_data + pkt_size + 4,
 				    hash_len);
 	return authentic;
 }
