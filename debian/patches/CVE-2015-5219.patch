From 5f295cd05c3c136d39f5b3e500a2d781bdbb59c8 Mon Sep 17 00:00:00 2001
From:  <stenn@deacon.udel.edu>
Date: Wed, 24 Apr 2013 19:13:53 -0400
Subject: [PATCH] [Bug 2382] Implement LOGTOD using ldexp() instead of shifting

---
 ChangeLog     | 1 +
 include/ntp.h | 5 ++---
 2 files changed, 3 insertions(+), 3 deletions(-)

Index: ntp-4.2.6.p5+dfsg/include/ntp.h
===================================================================
--- ntp-4.2.6.p5+dfsg.orig/include/ntp.h	2015-10-22 15:17:12.632029576 -0400
+++ ntp-4.2.6.p5+dfsg/include/ntp.h	2015-10-22 15:17:12.632029576 -0400
@@ -163,10 +163,9 @@
 #define SQUARE(x) ((x) * (x))
 #define SQRT(x) (sqrt(x))
 #define DIFF(x, y) (SQUARE((x) - (y)))
-#define LOGTOD(a)	((a) < 0 ? 1. / (1L << -(a)) : \
-			    1L << (int)(a)) /* log2 to double */
+#define LOGTOD(a)	ldexp(1., (int)(a)) /* log2 to double */
 #define UNIVAR(x)	(SQUARE(.28867513 * LOGTOD(x))) /* std uniform distr */
-#define ULOGTOD(a)	(1L << (int)(a)) /* ulog2 to double */
+#define ULOGTOD(a)	ldexp(1., (int)(a)) /* ulog2 to double */
 
 #define	EVENT_TIMEOUT	0	/* one second, that is */
 
